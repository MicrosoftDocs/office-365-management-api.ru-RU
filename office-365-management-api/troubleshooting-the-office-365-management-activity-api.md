---
ms.TocTitle: Troubleshooting the Office 365 Management Activity API
title: Устранение неполадок, связанных с API действий управления Office 365
description: Сводка по наиболее распространенным вопросам об этом API, задаваемым службе поддержки Майкрософт.
ms.ContentId: 50822603-a1ec-a754-e7dc-67afe36bb1b0
ms.topic: reference (API)
ms.date: ''
localization_priority: Priority
ms.openlocfilehash: f02088f557a10414539952c78542e09b2dc2d90b
ms.sourcegitcommit: 37737b849f1b2d0484e626002978b1d4ece2c742
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/30/2019
ms.locfileid: "35936231"
---
# <a name="troubleshooting-the-office-365-management-activity-api"></a>Устранение неполадок, связанных с API действий управления Office 365

API действий управления Office 365 (другое название — *API единого аудита*) входит в состав предложений для обеспечения безопасности и соответствия требованиям в Office 365, но ему уделяется много внимания, потому что он:

- предоставляет программный доступ к нескольким рабочим нагрузкам конвейера аудита (например, SharePoint и Exchange);
- является основным интерфейсом, который используют различные продукты от сторонних поставщиков, чтобы агрегировать и индексировать данные аудита.

API действий управления не следует путать с API связи со службой Office 365. API действий управления используется для аудита действий пользователей в различных рабочих нагрузках.  API связи со службой предназначен для аудита состояния и сообщений, отправляемых службами, которые доступны в Office 365 (например, Dynamics CRM или службой идентификации).

Несмотря на относительно небольшое количество операций и простоту интерфейса REST, у пользователей часто возникают вопросы о работе с API действий управления и тонкостях процесса получения данных.  Каждому, кто начинает работать с API действий управления, следует понимать, что в этом интерфейсе отсутствует возможность запрашивать события по конкретным характеристикам, например дате события, семейству веб-сайтов, в котором оно произошло, или типу события.  Вместо этого создаются подписки на определенные рабочие нагрузки (например, SharePoint или Azure AD), по одной на клиент.

В этой статье представлена сводка по наиболее распространенным вопросам об этом API, задаваемым службе поддержки Майкрософт.  Мы покажем подборку простых скриптов PowerShell, которая может помочь вам найти ответы на самые распространенные вопросы пользователей и начать реализовывать собственное решение с использованием основных операций.  В этой статье описываются не все операции, но их полный список представлен в статье [Справочник по API действий управления Office 365](office-365-management-activity-api-reference.md).

## <a name="questions-about-third-party-tools-and-clients"></a>Вопросы о сторонних средствах и клиентах

Наиболее распространенная категория вопросов от клиентов нашей службы поддержки связана с использованием сторонних продуктов для скачивания и агрегирования данных аудита. В зависимости от стороннего продукта, у пользователей могут возникать трудности с настройкой либо перебои или несоответствия данных, предоставляемых в этих продуктах. Тут следует отметить, что первое действие, которое следует предпринять таким клиентам, — обратиться в службу поддержки поставщика соответствующего продукта. Из всех запросов на обслуживание, поступивших в службу поддержки, инженеры обнаружили только один случай, когда причиной неполадок была проблема со службой в конкретном клиенте.

Тем не менее у этих пользователей по-прежнему могут оставаться вопросы. Сторонние поставщики могут настаивать на том, что это проблема со службой, или пользователи просто хотят провести некоторые проверки, прежде чем обращаться к поставщику. 

## <a name="enabling-unified-audit-logging-in-office-365"></a>Включение ведения единого журнала аудита в Office 365

Если вы только что настроили приложение, пытающееся использовать API действий управления, но оно не работает, убедитесь, что включено ведение единого журнала аудита для организации Office 365. Это выполняется путем включения журнала аудита Office 365. Инструкции см. в статье [Включение и отключение поиска в журнале аудита Office 365](https://docs.microsoft.com/office365/securitycompliance/turn-audit-log-search-on-or-off).

Если единый аудит не включен, как правило, вы будете получать сообщение об ошибке со следующей строкой: `Microsoft.Office.Compliance.Audit.DataServiceException: Tenant <tenantID> does not exist.`

## <a name="connecting-to-the-api"></a>Подключение к API

Большинство приложений подключаются к API с помощью обычного потока OAuth2 учетных данных клиента. Следовательно, для начала необходимо создать приложение Azure AD с разрешениями, необходимыми для доступа к данным API действий управления. В этой статье не представлены инструкции по регистрации приложения Azure AD. Дополнительные сведения см. в статье [Краткое руководство. Регистрация приложения в конечной точке Azure Active Directory](https://docs.microsoft.com/ru-RU/azure/active-directory/develop/active-directory-integrating-applications).

### <a name="azure-application-permissions"></a>Разрешения приложений Azure

В настоящее время для API действий управления Office 365 используются следующие три разрешения:

1. чтение данных о действиях в организации;
2. чтение сведений о работоспособности служб в организации;
3. чтение событий политик защиты от потери данных (DLP), в том числе при обнаружении конфиденциальной информации. 

> [!NOTE] 
> Необходимо включить как разрешения приложений, так и делегированные разрешения по крайней мере для первых двух из вышеуказанных наборов разрешений. Чтение событий политик защиты от потери данных потребуется, только если вас интересуют рабочие нагрузки DLP.

### <a name="getting-an-access-token"></a>Получение маркера доступа

В приведенном ниже скрипте PowerShell используются идентификатор приложения и секрет клиента, чтобы получить токен OAuth2 из конечной точки проверки подлинности для API действий управления. Затем маркер доступа помещается в переменную массива `$headerParams`, которую вы вложите в свой HTTP-запрос: 

```powershell
# Create app of type Web app / API in Azure AD, generate a Client Secret, and update the client id and client secret here
$ClientID = "<YOUR_APPLICATION_ID"
$ClientSecret = "<YOUR_CLIENT_SECRET>"
$loginURL = "https://login.microsoftonline.com/"
$tenantdomain = "<YOUR_DOMAIN>.onmicrosoft.com"
# Get the tenant GUID from Properties | Directory ID under the Azure Active Directory section
$TenantGUID = "<YOUR_TENANT_GUID>"
$resource = "https://manage.office.com"
# auth
$body = @{grant_type="client_credentials";resource=$resource;client_id=$ClientID;client_secret=$ClientSecret}
$oauth = Invoke-RestMethod -Method Post -Uri $loginURL/$tenantdomain/oauth2/token?api-version=1.0 -Body $body
$headerParams = @{'Authorization'="$($oauth.token_type) $($oauth.access_token)"} 
```

Переменная `$oauth` будет содержать объект отклика, у которого есть ряд свойств, в том числе маркер доступа. Вот пример такого отклика:

```json
token_type     : Bearer
expires_in     : 3599
ext_expires_in : 0
expires_on     : 1508285860
not_before     : 1508281960
resource       : https://manage.office.com
access_token   : eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IjJLVmN1enFBaWRPTHFXU2FvbDd3Z0ZSR0NZbyIsImtpZCI6IjJLVmN1enFBaWRPTHFXU2FvbDd3Z0ZSR0NZbyJ9.eyJhdWQiOiJodHRwczov…
```

## <a name="checking-your-subscriptions"></a>Проверка подписок

Если произойдет перебой потока данных в имеющиеся клиент или решение, использующие API действий управления, вы можете подумать, что с вашей подпиской что-то не так. Чтобы проверить активные подписки, добавьте к предыдущему скрипту следующий код:

```powershell
Invoke-WebRequest -Headers $headerParams -Uri "https://manage.office.com/api/v1.0/$tenantGUID/activity/feed/subscriptions/list" 
```

#### <a name="sample-response"></a>Пример отклика 

```json
StatusCode        : 200
Status Description : OK
Content           : [{"contentType":"Audit.Exchange","status":"enabled","webhook":null},{"contentType":"Audit.SharePoint","status":"enabled","webhook":{"authId":"","address":"https://mvcwebapiwebhookreceiver.azurewebsite...
RawContent        : HTTP/1.1 200 OK
                    Pragma: no-cache
                    Content-Length: 266
                    Cache-Control: no-cache
                    Content-Type: application/json; charset=utf-8
                    Expires: -1
                    Server: Microsoft-IIS/8.5,Microsoft-IIS/8.5
                    X-AspNet-Versi...
Forms             : {}
Headers           : {[Pragma, no-cache], [Content-Length, 266], [Cache-Control, no-cache], [Content-Type, application/json; charset=utf-8]...}
Images            : {}
InputFields       : {}
Links             : {}
ParsedHtml        : mshtml.HTMLDocumentClass
RawContentLength  : 266
```

Это означает, что для клиента включены подписки Audit.Exchange и Audit.SharePoint. Для подписки Exchange веб-перехватчик не включен (null), а для подписки SharePoint включен веб-перехватчик с адресом зарегистрированной конечной точки.

## <a name="creating-a-new-subscription"></a>Создание новой подписки

Чтобы создать новую подписку, используйте операцию /start:

```powershell
Invoke-WebRequest -Method Post -Headers $headerParams -Uri "https://manage.office.com/api/v1.0/$tenantGUID/activity/feed/subscriptions/start?contentType=Audit.AzureActiveDirectory"
```

> [!NOTE] 
> Помните, что заголовок `$headerParams` был заполнен в первой части скрипта в разделе [Подключение к API](#connecting-to-the-api) этой статьи.

Приведенный выше код создаст новую подписку на тип контента Audit.AzureActiveDirectory, где для параметра webhook задано значение null. Затем вы можете проверить свои подписки, используя код из раздела [Проверка подписок](#checking-your-subscriptions) этой статьи.

## <a name="checking-content-availability"></a>Проверка доступности контента

Чтобы проверить, какие большие двоичные объекты с контентом были созданы за определенный период, вы можете добавить следующую строку в скрипт из раздела "Подключение к API":

```powershell
Invoke-WebRequest -Method GET -Headers $headerParams -Uri "https://manage.office.com/api/v1.0/$tenantGUID/activity/feed/subscriptions/content?contentType=Audit.SharePoint"
```

В приведенном выше примере показано, как получить все уведомления о контенте, который стал доступен сегодня, то есть с 12:00 (в формате UTC) по текущее время. Если вы хотите указать другой временной период (учитывая, что максимальный период запроса составляет 24 часа), добавьте параметры *starttime* и *endtime* к URI. Пример:

```powershell
Invoke-WebRequest -Method GET -Headers $headerParams -Uri "https://manage.office.com/api/v1.0/$tenantGUID/activity/feed/subscriptions/content?contentType=Audit.SharePoint&startTime=2017-10-13T00:00&endTime=2017-10-13T11:59"
```

> [!NOTE] 
> Необходимо либо указать параметры *starttime* и *endtime*, либо не указывать ни одного из них.

Приведенный выше запрос вернет объект JSON с коллекцией уведомлений, которые стали доступны в указанный период времени. Отклик будет выглядеть так:

```json
[{      "contentUri" : "https://manage.office.com/api/v1.0/<<your_tenant_guid>>/activity/feed/audit/20171014180051748005825$20171014180051748005825$audit_sharepoint$Audit_SharePoint",
        "contentId" : "20171014180051748005825$20171014180051748005825$audit_sharepoint$Audit_SharePoint",
        "contentType" : "Audit.SharePoint",
        "contentCreated" : "2017-10-13T18:00:51.748Z",
        "contentExpiration" : "2017-10-20T18:00:51.748Z",
}]
```

> [!IMPORTANT] 
> - Свойство *contentUri* — это URI, из которого можно получить большой двоичный объект с контентом. Сам объект содержит сведения о 1–N событиях. Коллекция может содержать до 30 объектов JSON, но в этих 30 URI контента может быть указано намного больше событий.
> - Свойство *contentCreated* — это не дата создания события, соответствующего уведомлению. Это дата создания уведомления. События, описываемые в большом двоичном объекте, могли быть созданы задолго до создания самого объекта. Следовательно, из API невозможно напрямую запрашивать события, произошедшие за тот или иной период.

### <a name="paging-contents-for-busy-tenants"></a>Разбиение контента на страницы для нагруженных клиентов

Во многих крупных клиентах Office 365 каждый час происходят тысячи событий. Если это верно для вашей организации, при попытке выполнить запрос для 24-часового периода, как в приведенном выше примере, может потребоваться получить больше уведомлений, чем можно вернуть в одном отклике. В этом случае вам потребуется реализовать некий логический цикл, каждый раз проверяя заголовки отклика на наличие значения заголовка **NextPageUrl:**. Дополнительные сведения см. в разделе [Разбивка на страницы](office-365-management-activity-api-reference.md#pagination) справочника по API действий управления Office 365. 

Логика этого цикла будет примерно такой:

```powershell
IF the NextPageUrl header is present in the response... 

THEN issue a new request substituting the Uri parameter in the above Invoke-WebRequest example for the value of the NextPageUrl header...
 
ELSE exit the loop
```

Этот повторяющийся код будет сложно тестировать, если у вас не очень активный клиент. В нашем тесте мы попытались выполнить в скрипте несколько тысяч операций обновления и не смогли создать достаточно большое количество уведомлений, чтобы потребовалось отправлять заголовок **NextPageUrl**.

## <a name="using-webhooks"></a>Использование веб-перехватчиков

Уведомление о создании больших двоичных объектов с контентом можно получить двумя способами. Подход с *отправкой* реализован при помощи конечной точки веб-перехватчика — веб-приложения, которое вы создаете и размещаете самостоятельно или на облачной платформе. Веб-перехватчик регистрируется во время создания подписки на тип контента для аудита. Вы также можете добавить регистрацию веб-перехватчика к имеющейся подписке, используя показанный ниже подход. Подход с *получением* требует запрашивать данные за определенный временной диапазон (не более 24 часов) с помощью [операции /content](office-365-management-activity-api-reference.md#list-available-content). В отклике будет указано, какие большие двоичные объекты были созданы за указанный период.

Прежде чем добавлять веб-перехватчик, учтите следующие две проблемы:

1. Корпорация Майкрософт отходит от использования веб-перехватчиков из-за сложности отладки и устранения неполадок. Как правило, размещается конечная точка WebApi, отвечающая на входящие запросы. Многие клиенты используют либо среды внешнего размещения (которые они не полностью контролируют), либо локальные среды (которые с трудом пропускают входящие HTTP-запросы). Сотрудники службы поддержки часто сталкиваются с проблемами, когда входящие запросы из конвейера аудита Office 365 блокируются брандмауэром или маршрутизатором. В этом случае API реализует алгоритм отхода, который может быть запутанным и приводить к отключению веб-перехватчика в подписке.

2. Веб-перехватчик должен быть готов сразу ответить на отклик о проверке после выполнения операции запуска. Если в приложении веб-перехватчика возникнет ошибка, то проверка завершится сбоем, а веб-перехватчик не будет включен. Сведения о схеме запросов на проверку см. в разделе [Проверка веб-перехватчиков](office-365-management-activity-api-reference.md#webhook-validation) справочника по API действий управления Office 365. Вам следует серьезно отнестись к трудностям при создании готового к работе веб-перехватчика для ответа на уведомления API действий управления.

Если вы решите реализовать веб-перехватчик, его следует протестировать, чтобы убедиться, что конечная точка готова вернуть отклик HTTP 200 как на запрос проверки, так и на обычные запросы уведомлений перед операцией /start, указывающей, что конечная точка веб-перехватчика вызывается впервые. Как правило, для тестирования готовности используется макет запроса от API. Внимательно прочтите и соблюдайте инструкции из разделов [Проверка веб-перехватчиков](office-365-management-activity-api-reference.md#webhook-validation) и [Получение контента](office-365-management-activity-api-reference.md#retrieving-content) справочника по API действий управления Office 365, чтобы понять схему запросов этих двух типов.

Чтобы добавить подписку с конечной точкой веб-перехватчика, добавьте параметр body в запрос POST к конечной точке /start. Пример:

```json
$body = '{
    "webhook" : {
        "address": "https://webhook.myapp.com/o365/",
        "authId": "o365activityapinotification",
        "expiration": ""
    }}'
$uri = "https://manage.office.com/api/v1.0/$tenantGUID/activity/feed//subscriptions/start?contentType=Audit.SharePoint"
Invoke-RestMethod -Method Post -uri $uri -Headers $headerParams -Body $body
```

Сразу после этого вызова будет отправлен запрос на проверку по адресу `https://webhook.myapp.com/o365/ …`, где должен находиться готовый к ответу прослушиватель, как описано в разделе [Проверка веб-перехватчиков](office-365-management-activity-api-reference.md#webhook-validation) справочника по API действий управления Office 365. В ответ прослушиватель отправит отклик HTTP 200. Если сразу после этого выполнить операцию /list, вы не увидите никакого значения параметра webhook, кроме null, пока результаты проверки не будут успешно возвращены.

### <a name="checking-notifications-to-webhooks"></a>Проверка уведомлений для веб-перехватчиков

Важно понимать разницу между операциями /notifications и /content. Проверка уведомлений уместна только при наличии подписки на конечную точку веб-перехватчика. Эта операция сообщит вам, были ли успешными попытки отправки уведомлений вашему веб-перехватчику. Эту операцию не следует использовать для получения списка доступного контента. Для перекрестной проверки доступности контента относительно данных, уже полученных веб-перехватчиком, следует использовать операцию /content. Но сначала следует проверить наличие неудачных уведомлений с помощью [операции /notifications](office-365-management-activity-api-reference.md#list-notifications).

## <a name="requesting-content-blobs-and-throttling"></a>Запрос больших двоичных объектов с контентом и регулирование

Получив список URI контента, необходимо запросить объекты, указанные этими URI. Ниже представлен пример запроса большого двоичного объекта с контентом при помощи PowerShell. В этом примере предполагается, что вы уже использовали предыдущий пример из раздела [Получение маркера доступа](#getting-an-access-token) этой статьи, чтобы получить маркер доступа, и заполнили переменную `$headerParams` должным образом.

```powershell
# Get a content blob
$uri = 'https://manage.office.com/api/v1.0/<<your-tenant-guid>>/activity/feed/audit/<<ContentID>$audit_sharepoint$Audit_SharePoint'
$contents = Invoke-WebRequest -Method GET -Headers $headerParams -Uri $uri
```

Обратите внимание на следующие особенности переменной *$uri* в предыдущем примере:

- Мы использовали одинарные кавычки, чтобы среда PowerShell не интерпретировала символы *$* как переменные.
- Весь URI будет возвращен в свойстве *contentUri* отклика на предыдущий вызов конечной точки /content. Маркеры-заполнители представлены исключительно для примера.

При попытке получить доступные большие двоичные объекты многие пользователи (особенно работающие с нагруженными клиентами) сталкивались примерно с такими ошибками:

```json
Response Code 403: {'error':{'code':'AF429','message':'Too many requests. Method=GetBlob, PublisherId=00000000-0000-0000-0000-000000000000'}}
```

Скорее всего, это вызвано регулированием. Обратите внимание, что значение параметра PublisherId с большой вероятностью указывает, что клиент не указал параметр *PublisherIdentifier* в запросе. Кроме того, учтите, что правильное имя параметра — *PublisherIdentifier*, несмотря на то что в откликах об ошибке 403 указывается имя *PublisherId*.

> [!NOTE] 
> В справочнике по API параметр *PublisherIdentifier* указан в каждой операции API, но его также следует включить в запрос GET к URL-адресу contentUri при получении объекта с контентом.

Если вы совершаете простые вызовы API для устранения неполадок (например, проверяете, активна ли определенная подписка), вы можете спокойно пропускать параметр *PublisherIdentifier*, но весь код, рассчитанный на рабочую среду, обязательно должен включать параметр *PublisherIdentifier* в каждый вызов.

Если вы реализуете клиентское приложение для клиента компании, то *PublisherIdentifier* — это GUID клиента. Если вы создаете приложение или надстройку для нескольких пользователей как независимый поставщик программного обеспечения, то параметр *PublisherIdentifier* должен содержать GUID клиента независимого поставщика, а не GUID клиента компании пользователя.

Включив допустимый параметр *PublisherIdentifier*, вы получите пул, поддерживающий до 60 тысяч запросов в минуту для каждого клиента. Это исключительно большое количество запросов. Однако если не включить параметр *PublisherIdentifier*, вам будет предоставлен общий пул, рассчитанный 60 тысяч запросов в минуту для всех клиентов. В этом случае ваши вызовы наверняка будут регулироваться. Во избежание этого вы можете запросить большой двоичный объект с контентом при помощи параметра *PublisherIdentifier* следующим образом:

```powershell
$contentUri = ($response.Content | ConvertFrom-Json).contentUri[0]
$uri = $contentUri + '?PublisherIdentifier=82b24b6d-0591-4604-827b-705d55d0992f'
$contents = Invoke-WebRequest -Method GET -Headers $headerParams -Uri $uri
```

В предыдущем примере предполагается, что переменная *$response* содержит отклик на запрос к конечной точке /content, а переменная *$headerParams* включает действительный маркер доступа. Скрипт получает из отклика первый элемент массива URI контента, а затем отправляет запрос GET, чтобы скачать этот объект и добавить переменную *$contents*. Скорее всего, код циклически просмотрит коллекцию contentUri, отправляя запрос GET для каждого значения *contentUri*.

## <a name="frequently-asked-questions-about-the-office-365-management-api"></a>Часто задаваемые вопросы об API действий управления Office 365

#### <a name="what-is-the-maximum-time-i-will-have-to-wait-before-a-notification-is-sent-about-a-given-office-365-event"></a>Каков максимальный период ожидания отправки уведомления о том или ином событии Office 365?

Не существует гарантированной максимальной задержки для доставки уведомлений (другими словами, отсутствует соглашение об уровне обслуживания). Служба поддержки Майкрософт отмечает, что большинство уведомлений отправляются в течение одного часа после события. Зачастую задержка намного меньше, но она часто бывает и больше. Это в той или иной степени зависит от конкретной рабочей нагрузки, но в целом большинство уведомлений доставляются в течение 24 часов после соответствующего события.

#### <a name="arent-webhook-notifications-more-immediate-after-all-arent-they-are-event-driven"></a>Разве использование уведомлений веб-перехватчиков не предполагает более быстрое получение результатов? Они же создаются при появлении событий?

Нет. Уведомления веб-перехватчиков не создаются автоматически сразу после появления событий. Необходимо создать большой двоичный объект контента, что приводит к доставке уведомлений. В последнее время период ожидания уведомлений при использовании веб-перехватчиков был дольше, чем в случае отправки API запросов непосредственно с помощью операции /content. Следовательно, API действий управления не стоит рассматривать как систему оповещений о событиях безопасности в режиме реального времени. Корпорация Майкрософт предлагает для этого другие продукты. С точки зрения безопасности уведомления о событиях, получаемые с помощью API действий управления, больше подходят для определения тенденций использования за длительные периоды. 

#### <a name="can-i-query-the-management-activity-api-for-a-particular-event-id-or-recordtype-or-other-properties-in-the-content-blob"></a>Можно ли запросить у API действий управления определенный ИД события или RecordType либо другие свойства большого двоичного объекта с контентом?

Нет. Не следует рассматривать данные, доступные через API действий управления, как "журнал" в традиционном смысле. Правильнее считать его дампом сведений о событиях. Вам остается собрать все эти сведения о событиях, хранить и индексировать их в локальной среде, а затем реализовать собственную логику запросов, используя либо собственное приложение, либо стороннее средство.

#### <a name="how-do-i-know-the-data-coming-from-my-existing-auditing-solution-which-collects-data-from-the-management-activity-api-is-accurate-and-complete"></a>Как убедиться, что данные, поступающие из имеющегося решения для аудита, которое собирает данные из API действий управления, являются точными и полными?

Краткий ответ — корпорация Майкрософт не предоставляет никакого журнала, позволяющего проверить то или иное приложение либо стороннее решение. Существуют другие продукты от Майкрософт для обеспечения безопасности, которые получают свои данные из того же конвейера, но эти продукты не имеют отношения к данной теме и с их помощью невозможно непосредственно проверять API действий управления. Если вас беспокоят несоответствия между данными, которые предоставляет имеющееся решение, и вашими ожиданиями, то вам следует реализовать показанные выше операции. Однако это может быть сложно в зависимости от того, как имеющееся средство или решение перечисляет и индексирует данные. Если имеющееся решение только представляет данные, отсортированные по времени создания самого события, то запросить у API события по времени их создания для последующего сравнения будет невозможно. В этом случае вам придется собирать нужные объекты контента в течение нескольких дней, индексировать или сортировать их вручную, а затем выполнить приблизительное сравнение.

#### <a name="how-long-will-the-content-blobs-remain-available"></a>Как долго объекты контента будут оставаться доступными?

Большие двоичные объекты с контентом доступны в течение 7 дней после отправки уведомлений об их появлении. Это означает, что если при создании объекта с контентом существует значительная задержка, то у вас будет больше времени (задержка плюс 7 дней) после фактической даты события, пока этот объект не перестанет быть доступным.

#### <a name="if-there-is-a-24-hour-delay-in-getting-a-notification-doesnt-that-mean-i-will-have-only-6-days-to-retrieve-the-content-blob"></a>Если уведомления приходят с 24-часовой задержкой, не значит ли это, что у меня остается только 6 дней, чтобы получить объект с контентом?

Нет. Даже если уведомление задерживается на непривычно долгое время (например, при перебоях в работе службы), у вас все равно останется 7 дней после появления уведомления, чтобы скачать объект, связанный с первоначальным событием.












